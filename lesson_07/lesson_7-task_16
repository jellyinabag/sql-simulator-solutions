/*
Задание:
Из таблицы couriers выведите всю информацию о курьерах, которые в сентябре 2022 года доставили 30 и более заказов. Результат отсортируйте по возрастанию id курьера.
Поля в результирующей таблице: courier_id, birth_date, sex
*/

SELECT courier_id,
       birth_date,
       sex
FROM   couriers
WHERE  courier_id in (SELECT courier_id
                      FROM   courier_actions
                      WHERE  time between '2022-09-01 00:00:00'
                         and '2022-09-30 23:59:59'
                         and action = 'deliver_order'
                      GROUP BY courier_id having count(order_id) >= 30)
ORDER BY courier_id
